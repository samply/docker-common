# This workflow represents the continuous integration pipeline for the samply/tomcat-common docker image
name: Build, Test and Deploy samply/tomcat-common

on:
  workflow_dispatch:
  schedule:
    - cron: '0 8 * * *' # everyday at 8am
  push:
    branches:
      - main
    tags:
      - "*.*.*"
  pull_request:

jobs:
  ci:
    strategy:
      matrix:
        include:
          - tomcat_version: "10"
    uses: samply/github-workflows/.github/workflows/docker-ci.yml@v2
    with:
      image-name: "samply/tomcat"
      image-tag-prefix: "${{ matrix.tomcat_version }}-"
      build-file: "./tomcat/Dockerfile"
      build-args: |
        TOMCAT_VERSION=${{ matrix.tomcat_version }}
    secrets:
      DOCKERHUB_USERNAME: ${{ secrets.DOCKERHUB_USERNAME }}
      DOCKERHUB_TOKEN: ${{ secrets.DOCKERHUB_TOKEN }}
